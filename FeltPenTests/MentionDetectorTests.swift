//
//  MentionDetectorTests.swift
//  FeltPenTests
//
//  Created by Aleksei Gordeev on 26/09/2017.
//  Copyright Â© 2017 Aleksei Gordeev. All rights reserved.
//

import XCTest
@testable import FeltPen

class MentionDetectorTests: XCTestCase {
    
    private var detector: MentionDetector!
    
    override func setUp() {
        super.setUp()
        self.detector = MentionDetector.init()
    }
    
    override func tearDown() {
        self.detector = nil
        super.tearDown()
    }
    
    func testSimpleMention() {
        let string = "@gusnkt"
        let expectedRange = NSRange.init(fullRangeOfString: string)
        let attrString = NSMutableAttributedString.init(string: string)
        try! self.detector.process(text: attrString)
        
        var matchFound = false
        
        attrString.enumerateDetectorAttribute(.mention) { (v, range, _) in
            guard let _ = v else {
                return
            }
            
            matchFound = true
            
            XCTAssertTrue(NSEqualRanges(range, expectedRange),
                          "Expected: \(NSStringFromRange(expectedRange)), got: \(NSStringFromRange(range))")
        }
        
        XCTAssertTrue(matchFound)
    }
    
}
